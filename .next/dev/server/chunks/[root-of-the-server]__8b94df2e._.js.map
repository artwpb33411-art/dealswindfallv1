{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/dealswindfall/nextjs-boilerplate/lib/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabaseAdmin = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!, // server-only\r\n  { auth: { persistSession: false } }\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,IAAA,yMAAY,gFAEvC,QAAQ,GAAG,CAAC,yBAAyB,EACrC;IAAE,MAAM;QAAE,gBAAgB;IAAM;AAAE","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/dealswindfall/nextjs-boilerplate/app/api/track/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { supabaseAdmin } from \"@/lib/supabaseAdmin\";\r\n\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n\r\nconst { event_type, deal_id, page, user_agent, ip_address, referrer, utm_source, utm_medium, utm_campaign } = body;\r\n\r\n    if (!event_type) {\r\n      return NextResponse.json(\r\n        { error: \"Missing event_type\" },\r\n        { status: 400 }\r\n      );\r\n    }\r\n\r\n    const { data, error } = await supabaseAdmin\r\n      .from(\"analytics\")\r\n     .insert({\r\n  event_type,\r\n  deal_id: deal_id || null,\r\n  page: page || null,\r\n  referrer: referrer || null,\r\n  utm_source: utm_source || null,\r\n  utm_medium: utm_medium || null,\r\n  utm_campaign: utm_campaign || null,\r\n  user_agent: user_agent || null,\r\n  ip_address: ip_address || null,\r\n  created_at: new Date().toISOString(),\r\n})\r\n\r\n      .select()\r\n      .single();\r\n\r\n    if (error) {\r\n      console.error(\"Supabase insert error:\", error);\r\n\t   console.error(\"SUPABASE ERROR:\", error);  // <-- ADD THIS\r\n\t   console.log(\"TRACK BODY:\", body);\r\n\r\n      return NextResponse.json({ error: error.message }, { status: 500 });\r\n    }\r\n\r\n    return NextResponse.json({ ok: true, data });\r\n  } catch (e: any) {\r\n    console.error(\"TRACK API ERROR:\", e);\r\n    return NextResponse.json(\r\n      { error: e.message || \"Unknown server error\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAE/B,MAAM,EAAE,UAAU,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,EAAE,UAAU,EAAE,QAAQ,EAAE,UAAU,EAAE,UAAU,EAAE,YAAY,EAAE,GAAG;QAE1G,IAAI,CAAC,YAAY;YACf,OAAO,gJAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAAqB,GAC9B;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uIAAa,CACxC,IAAI,CAAC,aACN,MAAM,CAAC;YACX;YACA,SAAS,WAAW;YACpB,MAAM,QAAQ;YACd,UAAU,YAAY;YACtB,YAAY,cAAc;YAC1B,YAAY,cAAc;YAC1B,cAAc,gBAAgB;YAC9B,YAAY,cAAc;YAC1B,YAAY,cAAc;YAC1B,YAAY,IAAI,OAAO,WAAW;QACpC,GAEO,MAAM,GACN,MAAM;QAET,IAAI,OAAO;YACT,QAAQ,KAAK,CAAC,0BAA0B;YAC1C,QAAQ,KAAK,CAAC,mBAAmB,QAAS,eAAe;YACzD,QAAQ,GAAG,CAAC,eAAe;YAEzB,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,OAAO,MAAM,OAAO;YAAC,GAAG;gBAAE,QAAQ;YAAI;QACnE;QAEA,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;QAAK;IAC5C,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,oBAAoB;QAClC,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,EAAE,OAAO,IAAI;QAAuB,GAC7C;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}