{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/dealswindfall/nextjs-boilerplate/lib/supabaseAdmin.ts"],"sourcesContent":["import { createClient } from \"@supabase/supabase-js\";\r\n\r\nexport const supabaseAdmin = createClient(\r\n  process.env.NEXT_PUBLIC_SUPABASE_URL!,\r\n  process.env.SUPABASE_SERVICE_ROLE_KEY!, // server-only\r\n  { auth: { persistSession: false } }\r\n);\r\n"],"names":[],"mappings":";;;;AAAA;;AAEO,MAAM,gBAAgB,IAAA,yMAAY,gFAEvC,QAAQ,GAAG,CAAC,yBAAyB,EACrC;IAAE,MAAM;QAAE,gBAAgB;IAAM;AAAE","debugId":null}},
    {"offset": {"line": 61, "column": 0}, "map": {"version":3,"sources":["file:///C:/Projects/dealswindfall/nextjs-boilerplate/app/api/holiday-events/route.ts"],"sourcesContent":["import { NextResponse } from \"next/server\";\r\nimport { supabaseAdmin } from \"@/lib/supabaseAdmin\";\r\n\r\n// tiny helper to slugify names\r\nfunction slugify(name: string) {\r\n  return name\r\n    .toLowerCase()\r\n    .replace(/[^a-z0-9]+/g, \"-\")\r\n    .replace(/(^-|-$)/g, \"\");\r\n}\r\n\r\n/* -------------------------------------------\r\n   GET /api/holiday-events\r\n   - ?active=true  -> only active events\r\n   ------------------------------------------- */\r\nexport async function GET(req: Request) {\r\n  try {\r\n    const url = new URL(req.url);\r\n    const activeOnly = url.searchParams.get(\"active\") === \"true\";\r\n\r\n    let query = supabaseAdmin.from(\"holiday_events\").select(\"*\").order(\"start_date\", {\r\n      ascending: true,\r\n    });\r\n\r\n    if (activeOnly) {\r\n      query = query.eq(\"is_active\", true);\r\n    }\r\n\r\n    const { data, error } = await query;\r\n    if (error) throw error;\r\n\r\n    return NextResponse.json(data, { status: 200 });\r\n  } catch (e: any) {\r\n    console.error(\"GET /holiday-events error:\", e);\r\n    return NextResponse.json(\r\n      { error: e.message || \"Failed to fetch holiday events\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n/* -------------------------------------------\r\n   POST /api/holiday-events\r\n   body: { name, is_active?, start_date?, end_date? }\r\n   ------------------------------------------- */\r\nexport async function POST(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n    const name = (body.name || \"\").trim();\r\n\r\n    if (!name) throw new Error(\"Event name is required.\");\r\n\r\n    const slug = body.slug || slugify(name);\r\n\r\n    const { data, error } = await supabaseAdmin\r\n      .from(\"holiday_events\")\r\n      .insert({\r\n        name,\r\n        slug,\r\n        is_active: !!body.is_active,\r\n        start_date: body.start_date || null,\r\n        end_date: body.end_date || null,\r\n      })\r\n      .select()\r\n      .single();\r\n\r\n    if (error) throw error;\r\n\r\n    return NextResponse.json({ ok: true, event: data }, { status: 201 });\r\n  } catch (e: any) {\r\n    console.error(\"POST /holiday-events error:\", e);\r\n    return NextResponse.json(\r\n      { error: e.message || \"Failed to create holiday event\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n/* -------------------------------------------\r\n   PUT /api/holiday-events\r\n   body: { id, ...fieldsToUpdate }\r\n   ------------------------------------------- */\r\nexport async function PUT(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n    const { id, ...fields } = body;\r\n\r\n    if (!id) throw new Error(\"Missing event ID for update.\");\r\n\r\n    if (fields.name && !fields.slug) {\r\n      fields.slug = slugify(fields.name);\r\n    }\r\n\r\n    const { data, error } = await supabaseAdmin\r\n      .from(\"holiday_events\")\r\n      .update(fields)\r\n      .eq(\"id\", id)\r\n      .select()\r\n      .single();\r\n\r\n    if (error) throw error;\r\n\r\n    return NextResponse.json({ ok: true, event: data });\r\n  } catch (e: any) {\r\n    console.error(\"PUT /holiday-events error:\", e);\r\n    return NextResponse.json(\r\n      { error: e.message || \"Failed to update holiday event\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n\r\n/* -------------------------------------------\r\n   DELETE /api/holiday-events\r\n   body: { id }\r\n   ------------------------------------------- */\r\nexport async function DELETE(req: Request) {\r\n  try {\r\n    const body = await req.json();\r\n    const { id } = body;\r\n\r\n    if (!id) throw new Error(\"Missing event ID for delete.\");\r\n\r\n    const { error } = await supabaseAdmin\r\n      .from(\"holiday_events\")\r\n      .delete()\r\n      .eq(\"id\", id);\r\n\r\n    if (error) throw error;\r\n\r\n    return NextResponse.json({ ok: true, id }, { status: 200 });\r\n  } catch (e: any) {\r\n    console.error(\"DELETE /holiday-events error:\", e);\r\n    return NextResponse.json(\r\n      { error: e.message || \"Failed to delete holiday event\" },\r\n      { status: 500 }\r\n    );\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;AAAA;AACA;;;AAEA,+BAA+B;AAC/B,SAAS,QAAQ,IAAY;IAC3B,OAAO,KACJ,WAAW,GACX,OAAO,CAAC,eAAe,KACvB,OAAO,CAAC,YAAY;AACzB;AAMO,eAAe,IAAI,GAAY;IACpC,IAAI;QACF,MAAM,MAAM,IAAI,IAAI,IAAI,GAAG;QAC3B,MAAM,aAAa,IAAI,YAAY,CAAC,GAAG,CAAC,cAAc;QAEtD,IAAI,QAAQ,uIAAa,CAAC,IAAI,CAAC,kBAAkB,MAAM,CAAC,KAAK,KAAK,CAAC,cAAc;YAC/E,WAAW;QACb;QAEA,IAAI,YAAY;YACd,QAAQ,MAAM,EAAE,CAAC,aAAa;QAChC;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM;QAC9B,IAAI,OAAO,MAAM;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC,MAAM;YAAE,QAAQ;QAAI;IAC/C,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,EAAE,OAAO,IAAI;QAAiC,GACvD;YAAE,QAAQ;QAAI;IAElB;AACF;AAMO,eAAe,KAAK,GAAY;IACrC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,OAAO,CAAC,KAAK,IAAI,IAAI,EAAE,EAAE,IAAI;QAEnC,IAAI,CAAC,MAAM,MAAM,IAAI,MAAM;QAE3B,MAAM,OAAO,KAAK,IAAI,IAAI,QAAQ;QAElC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uIAAa,CACxC,IAAI,CAAC,kBACL,MAAM,CAAC;YACN;YACA;YACA,WAAW,CAAC,CAAC,KAAK,SAAS;YAC3B,YAAY,KAAK,UAAU,IAAI;YAC/B,UAAU,KAAK,QAAQ,IAAI;QAC7B,GACC,MAAM,GACN,MAAM;QAET,IAAI,OAAO,MAAM;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,OAAO;QAAK,GAAG;YAAE,QAAQ;QAAI;IACpE,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,+BAA+B;QAC7C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,EAAE,OAAO,IAAI;QAAiC,GACvD;YAAE,QAAQ;QAAI;IAElB;AACF;AAMO,eAAe,IAAI,GAAY;IACpC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,EAAE,EAAE,GAAG,QAAQ,GAAG;QAE1B,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;QAEzB,IAAI,OAAO,IAAI,IAAI,CAAC,OAAO,IAAI,EAAE;YAC/B,OAAO,IAAI,GAAG,QAAQ,OAAO,IAAI;QACnC;QAEA,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,uIAAa,CACxC,IAAI,CAAC,kBACL,MAAM,CAAC,QACP,EAAE,CAAC,MAAM,IACT,MAAM,GACN,MAAM;QAET,IAAI,OAAO,MAAM;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM,OAAO;QAAK;IACnD,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,8BAA8B;QAC5C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,EAAE,OAAO,IAAI;QAAiC,GACvD;YAAE,QAAQ;QAAI;IAElB;AACF;AAMO,eAAe,OAAO,GAAY;IACvC,IAAI;QACF,MAAM,OAAO,MAAM,IAAI,IAAI;QAC3B,MAAM,EAAE,EAAE,EAAE,GAAG;QAEf,IAAI,CAAC,IAAI,MAAM,IAAI,MAAM;QAEzB,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,uIAAa,CAClC,IAAI,CAAC,kBACL,MAAM,GACN,EAAE,CAAC,MAAM;QAEZ,IAAI,OAAO,MAAM;QAEjB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,IAAI;YAAM;QAAG,GAAG;YAAE,QAAQ;QAAI;IAC3D,EAAE,OAAO,GAAQ;QACf,QAAQ,KAAK,CAAC,iCAAiC;QAC/C,OAAO,gJAAY,CAAC,IAAI,CACtB;YAAE,OAAO,EAAE,OAAO,IAAI;QAAiC,GACvD;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}